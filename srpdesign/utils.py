import matplotlib.pyplot  as plt
import matplotlib  as mpl
import base64
from io import BytesIO
import matplotlib.dates as mdates
from datetime import datetime, timedelta
from matplotlib.ticker import NullFormatter
from matplotlib.dates import MonthLocator, DateFormatter
import numpy as np
import math
import pandas as pd
from opinflow.utility import draw_CompositePR_PI, draw_CompositeIPR_Darcy, draw_CompositeIPR_Multirate, draw_compositeIPR_Standing, draw_compositeIPR_Vogel, draw_compositeIPR_Wiggins
from opinflow.models import ProductivityIndexModel, DarcyModel, WigginsModel, VogelModel, StandingsModel, MultirateModel

def get_graph():
    buffer = BytesIO()
    plt.savefig(buffer, format='png')
    buffer.seek(0)
    image_png = buffer.getvalue()
    graph = base64.b64encode(image_png)
    graph = graph.decode('utf-8')
    buffer.close()
    return graph

def calculate_inflow(srpdata, selectedwell):     
    inflowdf = pd.DataFrame()  
    if selectedwell.inflow =='PI':        
        pimodels = ProductivityIndexModel.objects.filter(wellid=selectedwell.wellid).all()
        chart,xc,y, pis = draw_CompositePR_PI(pimodels)   
        #print(pis)    
    elif selectedwell.inflow =='Vogel':
        vogelmodels = VogelModel.objects.filter(wellid=selectedwell.wellid).all()        
        chart,xc,y= draw_compositeIPR_Vogel(vogelmodels)  
    elif selectedwell.inflow =='Standing':
        standingmodels = StandingsModel.objects.filter(wellid=selectedwell.wellid).all()        
        chart,xc,y = draw_compositeIPR_Standing(standingmodels) 
    elif selectedwell.inflow =='Wiggins':
        wigginmodels = WigginsModel.objects.filter(wellid=selectedwell.wellid).all()        
        chart,xc,y = draw_compositeIPR_Wiggins(wigginmodels) 
    elif selectedwell.inflow =='MultiRate':
        multiratemodels = MultirateModel.objects.filter(wellid=selectedwell.wellid).all()
        chart,xc,y =draw_CompositeIPR_Multirate(multiratemodels)  
    elif selectedwell.inflow =='Darcy':        
        darcymodels = DarcyModel.objects.filter(wellid=selectedwell.wellid).all()  
        chart,xc,y = draw_CompositeIPR_Darcy(darcymodels) 
    inflowdf['x2']= xc
    inflowdf['y2']= y
    x1=[]
    y1=[]
    pwf_inflow=0
    if srpdata.design_Liquid != 0:
        for index, row in inflowdf.iterrows(): 
            if srpdata.design_Liquid > row['x2'] :      
               x1 = [srpdata.design_Liquid,srpdata.design_Liquid,0 ]
               y1 = [0,row['y2'],row['y2'] ] 
               pwf_inflow=row['y2']     
               break
    #chart = get_ipr_plot(inflowdf, espdata, x1, y1)
    pip = pwf_inflow
    return inflowdf, x1, y1, pip
  

def get_ipr_plot(df, srpdata, x1, y1):
    plt.switch_backend('AGG')  
    plt.figure(figsize=(8,6))    
    plt.subplot(1,1,1)
    plt.subplot(1,1,1)
    plt.plot(x1, y1,  label='Outflow', color = "r", linestyle="dotted")
    plt.plot(df["x2"], df['y2'],  label='Inflow', color = "g")    
    plt.xlabel('Liquid Rate BOPD')
    plt.ylabel('Pressure in psi')
    plt.legend(loc="upper right")    
    plt.title("Inflow-outflow Plot")
    plt.ylim(0, max(df['y2'])+250)
    plt.xlim(0, max(df["x2"]) + 250)    
    plt.tight_layout()
    graph = get_graph()
    return graph


def calculate_srp_parameters(srpdata):
    # Non Dimensional Variables (From Tables 4.1 and 4.2)
    spgr_fluid = 0.9
    Wr = 1.833 
    Fe = 1.082
    Er =0.804*math.pow(10,-6)
    Et = 0.307 * math.pow(10,-6)
    Fo = 0.340*spgr_fluid *math.pow(srpdata.plunger_Dia,2)*srpdata.fluid_Level
    Fo = round(Fo)
    onebyKr = Er*srpdata.pump_Depth
    SKr = srpdata.surface_Stroke_Length/onebyKr
    SKr = round(SKr)
    FoSKr = Fo/SKr
    NNo = srpdata.pumping_Speed*srpdata.pump_Depth /245000
    NNoder = NNo/Fe   
    onebyKt = Et * srpdata.pump_Depth
    SpbyS =0.86 # from Figure 4.1
    
    SpbyS1 = get_SpbyS_from_Fig4_1(FoSKr,NNoder)
    print(SpbyS, SpbyS1)
    # Plunger Stroke

    if srpdata.anchored:
        Sp = SpbyS*srpdata.surface_Stroke_Length
    else:
        Sp = SpbyS*srpdata.surface_Stroke_Length  - (Fo * onebyKt)

    # Pump Displacement
    PD = 0.1166 * Sp * srpdata.pumping_Speed * math.pow(srpdata.plunger_Dia,2)
    W = Wr*srpdata.pump_Depth
    Wrt = W*(1-0.128*spgr_fluid )   
    WrtSkr = Wrt/SKr
    F1SKr = 0.465 # from fig 4.2
    F1SKr1 = get_F1SKR_from_Fig4_2(FoSKr,NNo)
    
    F2SKr = 0.213 # from fig 4.3
    F2SKr1 = get_F2SKR_from_Fig4_3(FoSKr,NNo)
    
    t2S2Kr =0.37 # from fig 4.4
    t2S2Kr1 = get_t2S2KR_from_Fig4_4(FoSKr,NNo)
    print(t2S2Kr, t2S2Kr1)
    F3SKr =0.29 # from Fig 4.5
    F3SKr1 = get_F3SKr_from_fig4_5(FoSKr, NNo)
    print(F3SKr, F3SKr1)
    Ta = 0.997 # from Fig 4.6
    Ta1=get_Ta_from_fig_4_6(FoSKr, NNoder)
    print(Ta, Ta1)
    # Peak Ploished Rod Load   
    PPRL = Wrt + (F1SKr)*SKr
    PPRL = round(PPRL)
    # Minimim Ploished Rod Load   
    MPRL = Wrt - (F2SKr)*SKr
    MPRL = round(MPRL)
    # Peak Torque
    PT = t2S2Kr*SKr * srpdata.surface_Stroke_Length/2*Ta
    PT = round(PT)
    # Polished Rod Horse Power  
    PRHP = F3SKr*SKr * srpdata.surface_Stroke_Length * srpdata.pumping_Speed *2.53 * math.pow(10,-6)
    PRHP = round(PRHP)
    # Counter Weight Required
    CBE = 1.06 *(Wrt+ 0.5* Fo)
    CBE = round(CBE)
    print(PPRL, MPRL, PT, PRHP, CBE)

    return PPRL, MPRL, PT, PRHP, CBE


def get_SpbyS_from_Fig4_1(FoSKr,NbyNo ):

    X1=[0.002604584	,    0.006280723,	0.014038973,	0.016424418,	0.022236337,   	0.026512778,	0.031504522,	0.032918867,	0.04155778,	0.050209821,	0.048664367,	0.058701967,	0.067264349,	0.071890954,	0.076082763,	0.080614205,	0.084420107,	0.089177119,	0.092986347,	0.097731718,	0.105188703,	0.107333368,	0.112949045,	0.118083341,	0.12685197,	0.123634901,	0.135103348,	0.14400710,0.15322861,	0.15518456, 0.161795653,	0.1699065, 	0.169829943,	0.176791724,	0.178321402,	0.185745991,	0.193451962,	0.201702898,	0.20300604,	0.209762,	    0.213746126,	0.218827978,	0.221547022,	0.227508602,	0.230266732,	0.236394805,	0.238821931,   	0.244870361,0.250322201,	0.25828709	, 0.267476704,	0.275254663,	0.274381403,	0.27700484, 0.284502856,	0.280972187,	0.293515307,	0.300980052,	0.301052731,	0.307709678,	0.309192167,	0.316072079,	0.323221901,	0.325168549,	0.32892275,	0.332724529,	0.330298201,	0.337525487,	0.346512404,	0.35034818, 	0.351481366,	0.353451383, 	0.35934160,	0.357831191,   	0.367256374,	0.37610744,    0.379559345,	0.377343015,	0.380650133, 	0.384100772, 	0.382825797,	0.389223187, 	0.398721123,	0.400997386,  	0.397961611,   	0.406363036,  	0.408669669, 	0.404882763, 	0.411426398, 	0.417441092,	0.426077106,	0.425723393,   	0.43336802,	0.434100976,	0.43340178, 	0.443306976, 	0.450632117,	0.450934033,	0.447112035,	0.451869413,	0.455948621, 	0.458991551, 	0.464506498, 	0.473776427,	0.47563671, 	0.479501379,	0.479315928,   	0.484080185,	0.488467299,	0.492923054,	0.497675684, 	0.500098223, 	0.500077019, 	0.506156927, 	0.50916979,  0.514642168,	0.523218594,	0.522861341,	0.531260371,	0.531238504, 	0.539816129,   0.539736111,	0.547893588,	0.551380937, 	0.547517032,	0.558577749,	0.561790435,	0.564838718,	0.570549048, 	0.573101396,	0.578641054,	0.584872817,	0.587488471,	0.59233514,	0.594000447,	0.598302552,	0.602542144,	0.606246387,	0.611361929,	0.616101115]
    Y1=[0.506540637	,    0.500681887,	0.506588853,	0.524425075,	0.507199945,   	0.524506976,	0.532273413,	0.514804236,	0.51414921,	0.518940106,	0.541130702,	0.51878504,	    0.518485245,	0.548490912,	0.524246142,	0.549584386,	0.526240809,	0.549428028,	0.526980926,	0.547030082,	0.535925431,	0.547072316,	0.535906915,	0.544568507,	0.54820878,	0.534414404,	0.548015635,	0.55229788,0.55883187,	0.54691737,	0.558250239,	0.5701593, 	0.549503332,	0.579422129,	0.551070823,	0.583535982,	0.58751086,	    0.579203938,	0.59471651,	0.583141797,	0.598514973,	0.575191928,	0.598138035,	0.571789951,	0.598277062,	0.571340798,	0.59604088	,   0.577615481,0.590239346,	0.596761291,  0.602320165,	0.61836042,	    0.598196729,	0.64401960, 0.639604632,	0.626040344,	0.649527681,	0.683118216,	0.652743492,	0.698422588,	0.678337013,	0.696679038,	0.721006988,	0.700446739,	0.75060812,	0.726152919,	0.701667991,	0.745043686,	0.752910519,	0.79708064, 	0.772023878,	0.752198361, 	0.79605609,	0.778632806,   	0.80105854,	    0.80862572,    0.829762126,	0.791932904,	0.843992652, 	0.829810692, 	0.800905736,	0.846569648, 	0.856320888,	0.872639047,  	0.823771946,   	0.850036473,  	0.886436509, 	0.870719698, 	0.850876414, 	0.898306916,	0.917856286,	0.892459024,   	0.94206212,	0.929784919,	0.89869983, 	0.945590106, 	0.968529607,	0.949650611,	0.922019422,	0.945305253,	0.995637025, 	0.976479262, 	0.994122805, 	1.000929037,	1.02147630, 	1.048951315,	0.998959057,   	1.024099397,	1.044431811,	1.039450566,	1.098098958, 	1.051608831, 	1.069210882, 	1.099244401, 	1.07198249,  1.095637797,	1.100713975,	1.125237777,	1.150856841,	1.109985147, 	1.148771267,   1.12720087,	1.146895619,	1.160367119, 	1.126102486,	1.158040082,	1.196302434,	1.178587531,	1.19643557, 	1.167449769,	1.203413945,	1.227747436,	1.198338709,	1.24569490,	1.204937846,	1.227914219,	1.255899386,	1.270733076,	1.250662433,	1.251555824]
    X2=[0.000687466	,    0.004513188,	0.01340629,	    0.017906883,	0.022151591,   	0.030296521,	0.030216297,	0.038785436,	0.04753285,	0.048608764,	0.055932176,	0.064503869,	0.073146175,	0.073150321,	0.081652045,	0.090226931,	0.098858378,	0.104335281,	0.108116107,	0.115969929,	0.124079263,	0.133127713,	0.141703916,	0.149977819,	0.15187765,	0.161051574,	0.169445609,	0.16778720,0.17319796,  0.17729195,	0.183078785,	0.1876095,  0.195472149,	0.203373681,	0.211933441,	0.221170744,	0.227284075,	0.229724583,	0.23764840,	0.237565402,	0.246208661,	0.246125807,	0.254774236,	0.25469256,	    0.263332716,	0.26326718,	    0.271373017,   	0.27257901, 0.280456194	,   0.28936756	, 0.297438168,	0.301110473,	0.302778451,	0.30477657, 0.309410344,	0.308106616,	0.318028753,	0.322876619,	0.326125024,	0.325625143,	0.325257807,	0.331429978,	0.333716506,	0.331261017,	0.34156519,	0.347910559,	0.349053287,	0.356514572,	0.355682588,	0.36471042, 	0.366062233,	0.37294962, 	0.37432839,	0.3804079	,   0.384469904,	0.38309113,    0.391384029,	0.393043398,	0.395108282, 	0.399428027, 	0.401531053,	0.409828401, 	0.418449712,	0.423257538,  	0.427038738,   	0.423106026,  	0.434935436, 	0.44360716, 	0.446150927, 	0.449669139,	0.448168499,	0.454565554,   	0.46359480,	0.471300951,	0.46977185, 	0.474712585, 	0.482802195,	0.491556661,	0.490614884,	0.497641963,	0.500100798, 	0.497468174, 	0.507299323, 	0.508686879,	0.5158641,      0.515803803,	0.522468378,   	0.524336432,	0.525749788,	0.527046224,	0.533958064, 	0.534591251, 	0.543822021, 	0.541655269, 	0.54970844,  0.546912711,	0.551473941,	0.558274814,	0.558937827,	0.566818034, 	0.564820888,   0.576139342,	0.575064974,	0.571883731, 	0.584138873,	0.582912946,	0.593124868,	0.596008197,	0.599534859, 	0.601856125,	0.605658223,	0.604833099]							
    Y2=[0.619324046	,    0.601323463,	0.602734198,	0.623254182,	0.604275452,   	0.626353227,	0.604727163,	0.606249007,	0.60740136,	0.631072237,	0.611573329,	0.613783666,	0.617540733,	0.636146774,	0.619495265,	0.622566219,	0.626893681,	0.648272292,	0.632159638,	0.636722844,	0.640211005,	0.645024489,	0.648450618,	0.651100934,	0.66280467,	0.656845092,	0.663628959,	0.64940879,0.69726074,	0.67579662,	0.69240523,	    0.6881087, 	0.69238633,	    0.693821465,	0.692814736,	0.689282721,	0.680318771,	0.691970733,	0.69941501,	0.677038981,	0.698541472,	0.676206424,	0.699102294,	0.677084855,	0.697750635,	0.68008409,	    0.689256838,   	0.671952815,0.696804409,	0.703138588,  0.707679758,	0.729518418,	0.698225741,	0.74718795, 0.737151188,	0.700495304,	0.751954617,	0.799633548,	0.772907657,	0.753577601,	0.741996577,	0.796901487,	0.783700404,	0.751354382,	0.8008702,  0.849998083,	0.816225614,	0.843432533,	0.829014686,	0.84925739, 	0.898874523,	0.866766322, 	0.89943713,	0.883624159,   	0.894341471,	0.94238626,    0.904417746,	0.949502347,	0.963994507, 	0.921772447, 	0.941549888,	0.944755011, 	0.960340763,	0.997226129,  	0.981214347,   	0.956382703,  	0.997335644, 	1.00552523, 	1.047677566, 	1.028393578,	0.996950564,	1.042524317,   	1.05507733,	1.071873076,	1.04941586, 	1.092146999, 	1.099312243,	1.150792876,	1.106777868,	1.128469728,	1.14557459, 	1.170408731, 	1.197340472, 	1.151663508,	1.19768614, 	1.162353465,	1.182531629,   	1.196429407,	1.23932008,	    1.204056554,	1.248494175, 	1.209321908, 	1.243912073, 	1.224828512, 	1.29712159,  1.277986767,	1.248396677,	1.297897569,	1.266765692,	1.292432254, 	1.2787117	,  1.344090839,	1.312028802,	1.29390155, 	1.344688865,	1.329005756,	1.353652488,	1.396401334,	1.367736368, 	1.398876576,	1.374507431,	1.361938714]								
    X3=[0.004557577,	0.013978029,	0.0173006	,   0.02124147	,   0.025476534,	0.030720828,	0.03366582,	0.042283551,	0.051086917,	0.048582425,	0.059409646,	0.067980009,	0.073490526,	0.076857211,	0.085123396,	0.093696686,	0.101816769,	0.104085287,	0.111632886,	0.120875196,	0.129477836,	0.136661033,	0.14604372,	0.149007907,	0.154550061,	0.16385385,0.17150543,	0.17622678,	0.178101988,	0.1858260, 	0.194679383,	0.19784666, 	0.203003537,	0.211575896,	0.220271443,	0.222550638,	0.22803469,	0.237260869,	0.245652557,	0.248210115,	0.255076762,	0.263084496,	0.26468236,	    0.271568971,	0.272105569,   	0.280064975,0.280742591,	0.288627889,  0.289309762,	0.297502542,	0.297000581,	0.30574733, 0.314944445,	0.320013901,	0.322843377,	0.320541279,	0.328430116,	0.337754344,	0.345472881,	0.347366719,	0.348356605,	0.352514954,	0.35627829,	0.363122262,	0.365006909,	0.371327987,	0.372379588,	0.37034211, 	0.373860653,	0.379983117, 	0.38258972,	0.388363612,   	0.390624036,	0.39567407,    0.399736983,	0.397246084,	0.403579011, 	0.41006793, 	0.412550171,	0.418297703, 	0.421405594,	0.423345998,  	0.430100378,   	0.437322542,  	0.442906592, 	0.447834169, 	0.448452368, 	0.456658294,	0.464229084,	0.464899783,   	0.47175309,	0.471154626,	0.47926046, 	0.486207833, 	0.487667354,	0.494886249,	0.495022463,	0.502243135,	0.502633299, 	0.498629991, 	0.509778406, 	0.510025749,	0.51816886, 	0.525357394,	0.522998886,   	0.529007948,	0.531620818,	0.530846565,	0.539117888, 	0.54437034, 	0.550363207, 	0.549322352, 	0.55888708,  0.566330128,	0.567924964,	0.573582925,	0.571967868,	0.57685584, 	0.572518048,   0.585341307,	0.581215581,	0.587639097, 	0.593807742,	0.596194502,	0.601235709]													
    Y3=[0.700731449,	0.704393363,	0.720645214,   	0.70370471	,   0.719737708,	0.705757589,	0.71849506,	0.709796036,	0.711500083,	0.728902757,	0.709555038,	0.711406785,	0.727856223,	0.712028858,	0.715827459,	0.718468105,	0.724853789,	0.720788711,	0.726747339,	0.729855629,	0.738409576,	0.744945603,	0.74995491,	0.728646898,	0.753624807,	0.75644277,0.76258928,	0.75091678,	0.780482326,	0.7903018, 	0.798467968,	0.777853553,	0.803902387,	0.806292019,	0.806912893,	0.826711955,	0.80604834,	0.804806939,	0.80046509,	    0.818353896,	0.793771002,	0.794063087,	0.781761325,	0.800319392,	0.777505695,   	0.801204238,0.774008884,	0.801047879,  0.775000015,	0.7974853	,   0.779593293,	0.79901393, 0.806594057,	0.848293229,	0.822958811,	0.799676191,	0.84515767,	    0.852860336,	0.8601917	,   0.895767225,	0.84782032,	    0.884509549,	0.89632770,	0.945787169,	0.902948378,	0.946201921,	0.922963257,	0.89837201, 	0.972447329,	0.94399901, 	0.99376496,	0.953859266,   	1.00199249,	    0.97660740,    0.994565153,	1.015631822,	0.991453149, 	1.009325157, 	1.048882827,	1.02429407, 	1.046862611,	1.021072379,  	1.049968314,   	1.057883298,  	1.07980568, 	1.097607808, 	1.073473717, 	1.105331949,	1.129201222,	1.1001412	,   1.13754506,	1.107378584,	1.15683553, 	1.17793008, 	1.151652847,	1.189831306,	1.155688717,	1.219420648,	1.198680824, 	1.168809612, 	1.236046822, 	1.197792748,	1.24936267, 	1.261790459,	1.232269744,   	1.295670649,	1.282999707,	1.249167807,	1.299552179, 	1.311007335, 	1.33783512, 	1.297973379, 	1.34994710,  1.36027492	,   1.400046032,	1.384698613,	1.421512988,	1.401305459, 	1.359964691,   1.409002466,	1.396097663,	1.448804288, 	1.432805026,	1.446623887,	1.441491309]													
    X4=[0.002927296,	0.011492604,   	0.017413117,	0.020604717,	0.028441986,	0.03026539,	    0.037203428,	0.045975897,	0.048213687,0.05434788,	    0.062923032,	0.06693738,	    0.070527819,	0.076277677,	0.08007307,	    0.082817693,	0.088642103,	0.097221955,	0.098081102,	0.106338085,	0.113165772,	0.11407584,	0.122953645,	0.131533427,	0.14010791,0.14861575,	0.15726066,	0.165839437,	0.1739275, 	0.183017463,	0.191600064,	0.200190647,	0.197127036,	0.208791694,	0.217374739,	0.22595916,	0.221968754,	0.235050133,	0.243130458,	0.243061353,	0.251713126,	0.251297591,	0.260275242,	0.260188245,   	0.26882645, 0.268753287	,   0.276678753,  0.279658323,	0.288222703,	0.296779764,	0.29724933, 0.305336559,	0.313900271,	0.32245547,	    0.327739716,	0.331624634,	0.339649424,	0.348451201,	0.347207469,	0.356888037,	0.365799683,	0.37263931,	0.372210614,	0.372467689,	0.381213579,	0.389809107,	0.39568666, 	0.396967465,	0.394458601, 	0.40516370,	0.412627235,   	0.415068408,	0.41934796,    0.427059716,	0.425200743,	0.433946016, 	0.434222743, 	0.440200282,	0.439207582, 	0.447900678,	0.451433399,  	0.447088623,   	0.455697813,  	0.459140216, 	0.467869247, 	0.471670664, 	0.475209036,	0.474606423,	0.482550739,   	0.49040048,	0.496702702,	0.49738623, 	0.505335191, 	0.512523567,	0.515131501,	0.518995446,	0.524204327,	0.521187388, 	0.532964121, 	0.531660569, 	0.538335977,	0.54150613, 	0.551215141,	0.550412195,   	0.546173772,	0.557982815,	0.555541471,	0.565052243, 	0.57191324, 	0.573807833, 	0.575151403, 	0.58235118,  0.580361045,	0.590570557,	0.592793199,	0.598103388,	0.596958642 ]																				
    Y4=[0.803395838,	0.803884942,   	0.825926915,	0.806488163,	0.808472528,	0.82782407,	    0.809368465,	0.813236716,	0.83936276,	0.814076011,	0.817218683,	0.850066194,	0.821105268,	0.849608749,	0.823432309,	0.84977622,	    0.824925465,	0.829335156,	0.851075415,	0.833021503,	0.840167904,	0.8344126,  0.840443556,	0.84483433,	    0.84779770,0.85028414,	0.85474285,	0.858860893,	0.8618699,  0.872619257,	0.877770034,	0.885072353,	0.856682991,	0.895195581,	0.900465888,	0.90610912,	0.879713852,	0.903012052,	0.918051831,	0.899423069,	0.923220537,	0.898646428,	0.922849025,	0.899397224,   	0.919537073,0.89981461	,   0.90770132	, 0.901443622,	0.90168251,	    0.899948355,	0.92160009, 0.898142482,	0.898201278,	0.895965096,	0.90388364,	    0.901840322,	0.91401698,	    0.940094889,	0.922791737,	0.944107933,	0.95401533,	    0.99297919,	0.972804197,	0.946712858,	0.995881439,	1.004516838,	1.02451807, 	1.045454852,	0.998720255, 	1.05138455,	1.069657154,   	1.098143949,	1.08589370,    1.112785974,	1.101336285,	1.150338662, 	1.109512519, 	1.138342024,	1.09967794, 	1.152103477,	1.190255892,  	1.125569446,   	1.164120197,  	1.19143945, 	1.201086699, 	1.246487685, 	1.220979374,	1.198439502,	1.24138795,   	1.25884196,	1.294994172,	1.27232847, 	1.297450278, 	1.308323361,	1.349967239,	1.328279401,	1.347360942,	1.373525217, 	1.400277985, 	1.363669316, 	1.379348377,	1.39448595, 	1.423469835,	1.40611744,   	1.393581717,	1.429044244,	1.400511231,	1.446009115, 	1.459252186, 	1.497792558, 	1.47523508, 	1.49236287,  1.480531123,	1.504527953,	1.549055638,	1.520496294,	1.547683442 ]																				
    X5=[0.001889083	,    0.00541960,	0.012877503,	0.021206312,   	0.028876895,	0.029130687,	0.038329063,	0.04702203,	0.055458394,	0.064024324,	0.073204286,	0.078881489,	0.081883525,	0.089714795,	0.098373327,	0.103526815,	0.106831312,	0.110791919,	0.112280439,	0.119049358,	0.120846865,	0.127939563,	0.129579728,	0.13719324,	0.137555631,	0.145024586,	0.14811135,0.15528943,	0.16459791,	0.173095266,	0.1761569, 	0.184083238,	0.192660784,	0.199000429,	0.199929932,	0.208391829,	0.208291796,	0.21726925,	0.216493874,	0.219547326,	0.22261307,	    0.227394176,	0.235312809,	0.243067945,	0.243097953,	0.248469833,   	0.248994415,0.256848054,	0.265434265,  0.27445494,	0.271980542,	0.282560288,	0.29181174, 0.300472976,	0.299787186,	0.307532854,	0.312835295,	0.316801045,	0.321558287,	0.327677431,	0.329902149,	0.336213173,	0.338444223,	0.34373665,	0.347016272,	0.355618028,	0.364093768,	0.372132973,	0.37249138, 	0.380515751,	0.386963945, 	0.38919676,	0.393546826,   	0.395276848,	0.40219000,    0.397829919,	0.403728193,	0.409811986, 	0.410502691, 	0.409628836,	0.412242673, 	0.418110765,	0.420253997,  	0.423890591,   	0.425767084,  	0.427428454, 	0.424994263, 	0.431377388, 	0.431782452,	0.431332393,	0.434525195,   	0.43993983,	0.436869315,	0.44199360, 	0.445544102, 	0.448464601,	0.449615338,	0.447478822,	0.455761281,	0.458199083, 	0.463217848, 	0.463653541, 	0.466827058,	0.47441376, 	0.475284783,	0.476053248,   	0.479837349,	0.482873111,	0.488400485,	0.496267414, 	0.50043703, 	0.495381586, 	0.508271178, 	0.51637623,  0.522087493,	0.526408953,	0.525186276,	0.522033144,	0.534037853,	0.539088443,	0.541486508, 	0.542759857,	0.546478005,	0.550498417,	0.553566444,	0.559124561,	0.561741731,	0.563084281,	0.572403602,	0.570536705,	0.576758534,	0.580227757,	0.584111623,	0.581104374,	0.58606624,	0.592690707,	0.599305312,	0.60140317, 0.6006422]
    Y5=[0.901273523,	0.898132144,	0.902780249,	0.904088407,   	0.899478957,	0.906684467,	0.902946298,	0.90287323,	0.903577869,	0.904234316,	0.902527684,	0.895705926,	0.905747502,	0.904231408,	0.908864753,	0.92000927,	    0.90140856,	    0.919769026,	0.901309059,	0.921209811,	0.944071622,	0.925337189,	0.947756508,	0.93151057,	0.946754676,	0.931513152,	0.94166150,0.93982174,	0.94390389,	0.943562764,	0.9539492,  0.950060531,	0.953848665,	0.983946176,	0.961693908,	0.997264572,	0.970298588,	0.99444972,	0.977801652,	1.01394564,	    0.983449265,	0.999141001,	1.003686726,	1.023619123,	0.999229942,	1.045762355,   	1.029778691,1.048283239,	1.05440699	, 1.054202233,	1.035276105,	1.054146867,	1.05442894, 1.056087882,	1.039107593,	1.045788935,	1.030836371,	1.050583385,	1.025403065,	1.04448916,	    1.014626154,	1.037007999,	1.008851882,	1.03646419,	1.011157844,	1.02147232,	    1.035972933,	1.047265941,	1.02305291, 	1.054662481,	1.076987255, 	1.04930925,	1.091938425,   	1.051407303,	1.11018947,    1.068086464,	1.099123579,	1.15019122, 	1.126524395, 	1.100819152,	1.175851262, 	1.148785331,	1.190227535,  	1.2060358	,   1.170061189,  	1.222180575, 	1.15060572, 	1.244889454, 	1.196687256,	1.180294837,	1.22252436,   	1.25210135,	1.203862291,	1.22112566, 	1.268840429, 	1.244660283,	1.291585735,	1.230755912,	1.259927388,	1.30249567, 	1.27632336, 	1.323819874, 	1.296816183,	1.32138802, 	1.297361687,	1.3086472	,   1.349380465,	1.328290298,	1.349283871,	1.35638099, 	1.386114087, 	1.342438352, 	1.399364434, 	1.4091948,   1.436286813,	1.451989029,	1.402205112,	1.391655667,	1.455174496,	1.477261104,	1.494127185, 	1.452640127,	1.475594289,	1.510076373,	1.497684012,	1.526965004,	1.497965069,	1.545086409,	1.553964424,	1.525388571,	1.573693232,	1.549530989,	1.592174474,	1.575980733,	1.54946024,	1.599836247,	1.625645396,	1.60905287, 1.596290131]
    X6=[0.005800046	,    0.014525498,	0.015217008,	0.023506159,	0.027771308,   	0.032108438,	0.037122187,	0.040055427,	0.04856120,	0.057188705,	0.065753481,	0.07431879,	    0.076300689,	0.083199483,	0.091456136,	0.100033604,	0.097372241,	0.108603967,	0.117175661,	0.122296941,	0.125747887,	0.134323305,	0.142898191,	0.15221144,	    0.15000547,	0.159353054,	0.160054348,	0.16789930,0.16922808,	0.17723317,	0.185810027,	0.1948041, 	0.197198442,	0.202969022,	0.211195134,	0.220694313,	0.220172199,	0.228799256,	0.22681648,	0.237389964,	0.24671402,	    0.251825586,	0.250605936,	0.259298591,	0.261414445,	0.266027532,	0.274238441,   	0.274581705,0.283650159,	0.292072902,  0.291980584,	0.297907062,	0.300191432,	0.30866265, 0.322565282,	0.321588963,	0.330804484,	0.339373074,	0.347871539,	0.347254293,	0.356522385,	0.365138881,	0.369916617,	0.373326833,	0.38160402,	0.389777395,	0.39485075,	    0.395622369,	0.399682734,	0.40049887, 	0.408233064,	0.413863746, 	0.41264455,	0.412099491,   	0.422513934,	0.42114235,    0.426868193,	0.421590103,	0.429102602, 	0.428670457, 	0.432711985,	0.439771597, 	0.440879779,	0.444616592,  	0.442777901,   	0.449012995,  	0.448052902, 	0.458037151, 	0.46262453, 	0.463302362,	0.468825487,	0.476548638,   	0.47518681,	0.480015533,	0.48203824, 	0.481398809, 	0.489568401,	0.495592098,	0.497152466,	0.49636196,	    0.501186003, 	0.508248647, 	0.51401184, 	0.516187249,	0.51970700, 	0.524846129,	0.5250948	,   0.532735146,	0.532416163,	0.539007204,	0.546884438, 	0.547515568, 	0.550461082, 	0.545898682, 	0.55626273,  0.555811684,	0.564844122,	0.567065544,	0.572084277,	0.575696218,	0.57514923,	    0.58032275, 	0.583714219,	0.595332488]																
    Y6=[0.948223644	,    0.949910466,	0.968432949,	0.950440757,	0.964953978,   	0.94990348	,   0.962352508,	0.948602264,	0.95053289,	0.950297653,	0.950643321,	0.951132425,	0.960742966,	0.952695917,	0.953924758,	0.957691718,	0.974778489,	0.959543465,	0.961753803,	0.978206762,	0.964107576,	0.967321966,	0.97039292	,   0.985962053,	0.97133001,	0.999068507,	0.97825606,	    0.99442055,0.98132895,	0.99222957,	0.995831245,	0.9989066, 	1.022834963,	1.004459378,	1.007948271,	1.049155157,	1.024997488,	1.04213235	,   1.03228753,	1.049468479,	1.057749229,	1.073457472,	1.044476367,	1.079294509,	1.055061348,	1.088418155,	1.08930787	,  1.071914873, 1.088116905	,   1.1001412,	  1.075255038,	1.098905033,	1.067633973,	1.06024723, 1.051483959,	1.08210185,  	1.048008643,	1.049382269,	1.049340649,	1.075321588,	1.055399865,	1.069687521,	1.098461576,	1.081454494,	1.10113449,	1.107071153,	1.127750565,	1.102577675,	1.147830017,	1.15797824, 	1.163359687,	1.193123995, 	1.17925541,	1.137253673,   	1.201503972,	1.16154606,    1.224382338,	1.177316923,	1.243767288, 	1.197227015, 	1.237401573,	1.251720194, 	1.298621082,	1.2636483,  	1.222689247,   	1.2945563,  	1.280580892, 	1.303813547, 	1.326243088, 	1.299105792,	1.342272066,	1.372236445,   	1.35489732,	1.397413796,	1.38305004,     1.350583196, 	1.401794164,	1.413177197,	1.448524096,	1.396858133,	1.438114884, 	1.453250945, 	1.462864163, 	1.494659163,	1.48411822, 	1.520372528,	1.503462626,   	1.548413868,	1.511804447,	1.539305767,	1.552870561, 	1.597895765, 	1.569965678, 	1.529286471, 	1.59494363,  1.578283464,	1.599766895,	1.649730988,	1.616119004,	1.629097055,	1.649533726,	1.635098776, 	1.649936768,	1.668948748	]															

    if FoSKr <=0.05 :
        x1 = []
        y1 = []
        x2 = X1
        y2 = Y1
    elif FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.05
        K2 = 0.1
    elif FoSKr <=0.2: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.1
        K2 = 0.2
    elif FoSKr <=0.3: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.2
        K2 = 0.3
    elif FoSKr <=0.4: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.3
        K2 = 0.4
    else: 
        x1 = X5
        y1 = Y5
        x2 = X6
        y2 = Y6
        K1 = 0.4
        K2 = 0.5

    i=0
    j=0
    SPbyS =0
    for xval in x1:       
        if xval >=  NbyNo:
            SPbyS = prevy +((y1[i]-prevy)*(NbyNo-prex)/(xval-prex))             
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NbyNo:
            SPbyS1 = prevy +((y2[j]-prevy)*(NbyNo-prex)/(xval1-prex))             
            break
        else:
            prex=xval1 
            prevy=y2[j]           
            j=j+1  
    
    corrected_Spbys = SPbyS + (SPbyS1-SPbyS)*(FoSKr-K1)/(K2-K1)
    return corrected_Spbys

def get_F1SKR_from_Fig4_2(FoSKr,NbyNo):


    X1=	[0.000,	0.001,	0.008,	0.014,	0.020,	0.025,	0.025,	0.031,	0.037,	0.043,	0.049,	0.051,	0.055,	0.061,	0.067,	0.073,	0.075,	0.079,	0.081,	0.085,	0.087,	0.093,	0.099,	0.102,	0.105,	0.111,	0.117,	0.123,	0.129,	0.127,	0.134,	0.140,	0.146,	0.152,	0.158,	0.164,	0.170,	0.176,	0.182,	0.188,	0.194,	0.194,	0.200,	0.200,	0.206,	0.205,	0.212,	0.218,	0.224,	0.226,	0.230,	0.235,	0.241,	0.248,	0.253,	0.259,	0.265,	0.271,	0.275,	0.277,	0.281,	0.283,	0.289,	0.295,	0.301,	0.305,	0.305,	0.311,	0.316,	0.322,	0.329,	0.326,	0.334,	0.340,	0.346,	0.352,	0.354,	0.360,	0.366,	0.371,	0.372,	0.377,	0.378,	0.383,	0.389,	0.395,	0.401,	0.401,	0.403,	0.409,	0.410,	0.415,	0.415,	0.421,	0.426,	0.428,	0.432,	0.438,	0.440,	0.444,	0.446,	0.452,	0.455,	0.458,	0.460,	0.461,	0.465,	0.467,	0.470,	0.475,	0.479,	0.480,	0.484,	0.489,	0.491,	0.497,	0.502,	0.503,	0.501,	0.505,	0.508,	0.509,	0.514,	0.520,	0.522,	0.526,	0.526,	0.526,	0.531,	0.537,	0.542,	0.543,	0.547,	0.550,	0.551,	0.556,	0.558,	0.560,	0.562,	0.562]				
    Y1=	[0.112,	0.101,	0.104,	0.105,	0.108,	0.111,	0.128,	0.113,	0.114,	0.116,	0.118,	0.136,	0.121,	0.124,	0.127,	0.130,	0.150,	0.133,	0.149,	0.136,	0.144,	0.142,	0.145,	0.155,	0.148,	0.152,	0.154,	0.155,	0.165,	0.151,	0.168,	0.172,	0.177,	0.180,	0.186,	0.191,	0.195,	0.197,	0.201,	0.202,	0.213,	0.198,	0.215,	0.198,	0.222,	0.198,	0.227,	0.232,	0.236,	0.218,	0.243,	0.247,	0.250,	0.253,	0.260,	0.267,	0.273,	0.278,	0.298,	0.282,	0.295,	0.288,	0.295,	0.299,	0.301,	0.311,	0.299,	0.315,	0.321,	0.327,	0.339,	0.324,	0.340,	0.346,	0.351,	0.355,	0.367,	0.366,	0.373,	0.398,	0.379,	0.397,	0.387,	0.394,	0.400,	0.407,	0.415,	0.433,	0.421,	0.425,	0.447,	0.433,	0.445,	0.443,	0.451,	0.464,	0.461,	0.472,	0.495,	0.481,	0.491,	0.496,	0.507,	0.495,	0.515,	0.495,	0.527,	0.542,	0.539,	0.546,	0.561,	0.545,	0.572,	0.583,	0.595,	0.600,	0.607,	0.595,	0.582,	0.625,	0.598,	0.636,	0.647,	0.650,	0.672,	0.648,	0.676,	0.661,	0.696,	0.697,	0.727,	0.697,	0.697,	0.746,	0.720,	0.746,	0.766,	0.746,	0.768,	0.761]				
    X2=	[0.001,	0.000,	0.007,	0.013,	0.019,	0.025,	0.025,	0.028,	0.034,	0.040,	0.046,	0.048,	0.052,	0.054,	0.058,	0.060,	0.064,	0.066,	0.070,	0.073,	0.076,	0.077,	0.081,	0.087,	0.093,	0.099,	0.103,	0.108,	0.114,	0.120,	0.126,	0.130,	0.135,	0.139,	0.141,	0.145,	0.147,	0.152,	0.151,	0.159,	0.165,	0.171,	0.176,	0.179,	0.185,	0.190,	0.196,	0.202,	0.203,	0.209,	0.208,	0.214,	0.220,	0.226,	0.230,	0.235,	0.241,	0.247,	0.252,	0.254,	0.260,	0.266,	0.272,	0.277,	0.277,	0.283,	0.289,	0.295,	0.301,	0.305,	0.306,	0.310,	0.316,	0.322,	0.328,	0.326,	0.334,	0.340,	0.346,	0.352,	0.354,	0.360,	0.365,	0.371,	0.377,	0.380,	0.385,	0.391,	0.397,	0.402,	0.403,	0.409,	0.415,	0.421,	0.424,	0.427,	0.433,	0.439,	0.445,	0.451,	0.455,	0.460,	0.467,	0.472,	0.477,	0.479,	0.483,	0.484,	0.490,	0.494,	0.499,	0.503,	0.502,	0.509,	0.513,	0.517,	0.520,	0.520,	0.526,	0.529,	0.526,	0.531,	0.534,	0.536,	0.536,	0.542,	0.544,	0.547,	0.549,	0.549,	0.553,	0.556]										
    Y2=	[0.204,	0.196,	0.200,	0.203,	0.208,	0.212,	0.234,	0.216,	0.216,	0.219,	0.222,	0.248,	0.226,	0.249,	0.230,	0.249,	0.233,	0.249,	0.239,	0.245,	0.243,	0.258,	0.246,	0.248,	0.251,	0.255,	0.262,	0.262,	0.266,	0.270,	0.274,	0.279,	0.281,	0.300,	0.285,	0.298,	0.290,	0.296,	0.282,	0.298,	0.302,	0.305,	0.312,	0.318,	0.318,	0.322,	0.327,	0.331,	0.348,	0.337,	0.347,	0.341,	0.346,	0.348,	0.353,	0.355,	0.361,	0.366,	0.369,	0.377,	0.377,	0.382,	0.388,	0.393,	0.381,	0.397,	0.400,	0.402,	0.404,	0.415,	0.400,	0.418,	0.423,	0.429,	0.440,	0.425,	0.440,	0.445,	0.449,	0.452,	0.461,	0.461,	0.467,	0.472,	0.477,	0.491,	0.488,	0.493,	0.498,	0.502,	0.513,	0.514,	0.521,	0.529,	0.542,	0.537,	0.545,	0.553,	0.564,	0.573,	0.590,	0.591,	0.600,	0.609,	0.623,	0.633,	0.645,	0.637,	0.650,	0.657,	0.673,	0.693,	0.684,	0.699,	0.706,	0.725,	0.742,	0.732,	0.747,	0.764,	0.728,	0.746,	0.777,	0.791,	0.783,	0.797,	0.814,	0.795,	0.823,	0.844,	0.833,	0.842]										
    X3=	[0.007,	0.025,	0.028,	0.034,	0.040,	0.045,	0.046,	0.051,	0.051,	0.057,	0.058,	0.063,	0.063,	0.069,	0.075,	0.079,	0.085,	0.091,	0.097,	0.103,	0.101,	0.109,	0.115,	0.121,	0.127,	0.133,	0.138,	0.144,	0.151,	0.156,	0.162,	0.168,	0.175,	0.181,	0.186,	0.192,	0.189,	0.198,	0.203,	0.203,	0.210,	0.216,	0.222,	0.227,	0.226,	0.233,	0.239,	0.245,	0.252,	0.255,	0.257,	0.260,	0.263,	0.265,	0.269,	0.275,	0.277,	0.281,	0.287,	0.293,	0.299,	0.305,	0.302,	0.311,	0.317,	0.317,	0.323,	0.323,	0.329,	0.326,	0.326,	0.335,	0.339,	0.345,	0.351,	0.354,	0.352,	0.357,	0.360,	0.366,	0.372,	0.374,	0.378,	0.379,	0.384,	0.386,	0.391,	0.397,	0.401,	0.403,	0.401,	0.409,	0.413,	0.415,	0.419,	0.420,	0.425,	0.426,	0.429,	0.431,	0.437,	0.441,	0.446,	0.447,	0.452,	0.452,	0.453,	0.458,	0.464,	0.470,	0.476,	0.477,	0.482,	0.488,	0.493,	0.499,	0.497,	0.503,	0.502,	0.502,	0.508,	0.514,	0.518,	0.518,	0.522,	0.522,	0.528,	0.529,	0.526,	0.532,	0.533,	0.538,	0.541,	0.546,	0.550,	0.551,	0.554,	0.557,	0.561]
    Y3=	[0.308,	0.335,	0.320,	0.321,	0.323,	0.351,	0.327,	0.351,	0.330,	0.351,	0.333,	0.351,	0.337,	0.343,	0.344,	0.350,	0.349,	0.352,	0.354,	0.362,	0.356,	0.363,	0.367,	0.370,	0.374,	0.378,	0.381,	0.385,	0.389,	0.395,	0.398,	0.400,	0.402,	0.404,	0.406,	0.416,	0.400,	0.419,	0.425,	0.418,	0.428,	0.432,	0.438,	0.442,	0.427,	0.446,	0.449,	0.452,	0.454,	0.447,	0.462,	0.449,	0.467,	0.449,	0.472,	0.476,	0.460,	0.482,	0.487,	0.493,	0.497,	0.501,	0.490,	0.502,	0.514,	0.497,	0.520,	0.497,	0.527,	0.513,	0.500,	0.533,	0.539,	0.544,	0.548,	0.556,	0.534,	0.546,	0.559,	0.566,	0.573,	0.598,	0.580,	0.598,	0.588,	0.595,	0.596,	0.602,	0.629,	0.613,	0.608,	0.618,	0.650,	0.628,	0.649,	0.632,	0.647,	0.672,	0.657,	0.651,	0.657,	0.698,	0.672,	0.698,	0.683,	0.698,	0.709,	0.698,	0.703,	0.713,	0.725,	0.745,	0.736,	0.747,	0.752,	0.769,	0.746,	0.792,	0.781,	0.762,	0.796,	0.802,	0.822,	0.796,	0.842,	0.832,	0.847,	0.859,	0.826,	0.846,	0.868,	0.882,	0.896,	0.901,	0.921,	0.898,	0.933,	0.926,	0.927]
    X4=	[0.001,	0.001,	0.008,	0.014,	0.019,	0.025,	0.028,	0.034,	0.040,	0.045,	0.051,	0.057,	0.063,	0.070,	0.075,	0.076,	0.081,	0.087,	0.093,	0.099,	0.103,	0.105,	0.111,	0.117,	0.114,	0.123,	0.128,	0.126,	0.134,	0.140,	0.146,	0.152,	0.152,	0.158,	0.164,	0.170,	0.176,	0.178,	0.182,	0.188,	0.194,	0.200,	0.204,	0.210,	0.215,	0.221,	0.227,	0.227,	0.233,	0.233,	0.239,	0.245,	0.251,	0.251,	0.257,	0.263,	0.269,	0.269,	0.275,	0.272,	0.281,	0.287,	0.293,	0.299,	0.302,	0.305,	0.310,	0.316,	0.323,	0.328,	0.326,	0.334,	0.340,	0.346,	0.353,	0.351,	0.356,	0.361,	0.367,	0.373,	0.378,	0.377,	0.385,	0.391,	0.392,	0.396,	0.402,	0.401,	0.404,	0.409,	0.414,	0.420,	0.426,	0.427,	0.429,	0.433,	0.434,	0.439,	0.440,	0.445,	0.453,	0.452,	0.452,	0.462,	0.465,	0.469,	0.471,	0.474,	0.477,	0.480,	0.487,	0.492,	0.498,	0.503,	0.501,	0.509,	0.514,	0.517,	0.520,	0.525,	0.526,	0.529,	0.533,	0.535,	0.538,	0.541,	0.546,	0.550,	0.550,	0.554,	0.558,	0.557,	0.559,	0.564]									
    Y4=	[0.405,	0.398,	0.403,	0.404,	0.407,	0.413,	0.420,	0.419,	0.422,	0.425,	0.429,	0.432,	0.435,	0.440,	0.443,	0.432,	0.447,	0.449,	0.451,	0.454,	0.460,	0.457,	0.456,	0.465,	0.451,	0.468,	0.473,	0.467,	0.475,	0.478,	0.482,	0.495,	0.483,	0.490,	0.494,	0.496,	0.498,	0.509,	0.502,	0.507,	0.510,	0.514,	0.519,	0.520,	0.524,	0.528,	0.546,	0.531,	0.543,	0.536,	0.542,	0.545,	0.549,	0.535,	0.552,	0.553,	0.561,	0.547,	0.565,	0.547,	0.570,	0.574,	0.579,	0.584,	0.595,	0.588,	0.595,	0.599,	0.603,	0.606,	0.596,	0.616,	0.623,	0.630,	0.637,	0.619,	0.642,	0.647,	0.653,	0.655,	0.668,	0.650,	0.676,	0.682,	0.696,	0.690,	0.696,	0.681,	0.706,	0.701,	0.705,	0.714,	0.719,	0.745,	0.726,	0.746,	0.728,	0.740,	0.735,	0.741,	0.750,	0.775,	0.762,	0.763,	0.796,	0.773,	0.796,	0.780,	0.794,	0.790,	0.798,	0.806,	0.821,	0.832,	0.809,	0.846,	0.850,	0.864,	0.846,	0.848,	0.872,	0.858,	0.868,	0.897,	0.882,	0.896,	0.902,	0.947,	0.919,	0.930,	0.957,	0.923,	0.933,	0.957]									
    X5=	[0.001,	0.003,	0.009,	0.015,	0.021,	0.029,	0.027,	0.034,	0.037,	0.040,	0.046,	0.047,	0.052,	0.058,	0.058,	0.063,	0.070,	0.076,	0.077,	0.081,	0.087,	0.094,	0.099,	0.102,	0.105,	0.111,	0.117,	0.123,	0.129,	0.126,	0.135,	0.145,	0.151,	0.151,	0.156,	0.162,	0.168,	0.175,	0.177,	0.180,	0.186,	0.192,	0.191,	0.198,	0.204,	0.201,	0.210,	0.216,	0.222,	0.228,	0.227,	0.233,	0.240,	0.246,	0.251,	0.251,	0.257,	0.263,	0.269,	0.275,	0.279,	0.285,	0.291,	0.296,	0.297,	0.302,	0.303,	0.308,	0.309,	0.314,	0.315,	0.321,	0.326,	0.332,	0.338,	0.343,	0.350,	0.354,	0.356,	0.362,	0.368,	0.371,	0.374,	0.378,	0.379,	0.382,	0.385,	0.391,	0.398,	0.403,	0.401,	0.409,	0.415,	0.421,	0.427,	0.426,	0.433,	0.439,	0.443,	0.444,	0.449,	0.452,	0.454,	0.459,	0.477,	0.478,	0.480,	0.484,	0.485,	0.491,	0.491,	0.496,	0.502,	0.503,	0.509,	0.515,	0.515,	0.521,	0.527,	0.529,	0.535,	0.539,	0.540,	0.544,	0.550,	0.555,	0.558]																
    Y5=	[0.518,	0.503,	0.507,	0.510,	0.514,	0.547,	0.521,	0.549,	0.525,	0.549,	0.549,	0.532,	0.549,	0.546,	0.537,	0.541,	0.545,	0.547,	0.559,	0.550,	0.552,	0.553,	0.557,	0.548,	0.564,	0.568,	0.571,	0.575,	0.578,	0.559,	0.580,	0.585,	0.589,	0.571,	0.594,	0.597,	0.600,	0.601,	0.586,	0.603,	0.605,	0.615,	0.599,	0.619,	0.622,	0.612,	0.626,	0.630,	0.634,	0.642,	0.626,	0.642,	0.646,	0.649,	0.652,	0.665,	0.655,	0.659,	0.663,	0.666,	0.671,	0.672,	0.676,	0.698,	0.679,	0.697,	0.683,	0.699,	0.686,	0.697,	0.688,	0.692,	0.695,	0.697,	0.699,	0.699,	0.703,	0.712,	0.707,	0.715,	0.726,	0.743,	0.736,	0.748,	0.756,	0.749,	0.764,	0.775,	0.783,	0.790,	0.775,	0.794,	0.797,	0.802,	0.808,	0.824,	0.812,	0.818,	0.846,	0.822,	0.846,	0.855,	0.845,	0.844,	0.866,	0.888,	0.871,	0.896,	0.877,	0.894,	0.884,	0.895,	0.902,	0.916,	0.917,	0.946,	0.929,	0.941,	0.952,	0.963,	0.968,	0.996,	0.979,	0.992,	1.000,	1.010,	1.006]																

    if FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = 0
        y2 = 0
        K1 = 0.0
        K2 = 0.1
    elif FoSKr <=0.2: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.1
        K2 = 0.2
    elif FoSKr <=0.3: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.2
        K2 = 0.3
    elif FoSKr <=0.4: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.3
        K2 = 0.4
    else: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.4
        K2 = 0.5

    i=0
    j=0
    F1SKr =0
   
    for xval in x1:       
        if xval >=  NbyNo:            
            F1SKr = prevy +((y1[i]-prevy)*(NbyNo-prex)/(xval-prex)) 
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NbyNo:            
            F1SKr1 = prevy +((y2[j]-prevy)*(NbyNo-prex)/(xval1-prex)) 
            break
        else:
            prex=xval1 
            prevy=y2[j]  
            j=j+1  
    
    corrected_Spbys = F1SKr + (F1SKr1-F1SKr)*(FoSKr-K1)/(K2-K1)

    return corrected_Spbys

def get_F2SKR_from_Fig4_3(FoSKr,NbyNo):

    X1=[0.008,	0.026,	0.044,	0.061,	0.078,	0.096,	0.113,	0.130,	0.147,	0.156,	0.155,	0.165,	0.171,	0.180,	0.191,	0.194,	0.203,	0.217,	0.220,	0.230,	0.239,	0.246,	0.254,	0.269,	0.264,	0.279,	0.286,	0.296,	0.290,	0.303,	0.295,	0.312,	0.304,	0.319,	0.327,	0.324,	0.335,	0.346,	0.344,	0.359,	0.356,	0.368,	0.369,	0.382,	0.381,	0.399,	0.397,	0.414,	0.414,	0.429,	0.442,	0.453,	0.467,	0.476,	0.486,	0.486,	0.496,	0.508,	0.513,	0.505,	0.519,	0.515,	0.526,	0.532,	0.527,	0.541,	0.535,	0.548,	0.542,	0.555]					
    Y1=[0.004,	0.008,	0.011,	0.015,	0.021,	0.027,	0.033,	0.042,	0.050,	0.061,	0.050,	0.068,	0.063,	0.073,	0.083,	0.072,	0.088,	0.101,	0.095,	0.107,	0.118,	0.113,	0.129,	0.141,	0.128,	0.152,	0.162,	0.169,	0.150,	0.183,	0.160,	0.194,	0.170,	0.185,	0.205,	0.191,	0.220,	0.229,	0.218,	0.246,	0.236,	0.258,	0.249,	0.268,	0.260,	0.276,	0.272,	0.286,	0.281,	0.292,	0.301,	0.306,	0.317,	0.326,	0.337,	0.323,	0.348,	0.362,	0.372,	0.347,	0.380,	0.360,	0.390,	0.401,	0.378,	0.412,	0.389,	0.423,	0.399,	0.430]					
    X2=[0.000,	0.016,	0.027,	0.041,	0.059,	0.075,	0.093,	0.086,	0.109,	0.122,	0.120,	0.139,	0.132,	0.154,	0.151,	0.168,	0.165,	0.182,	0.179,	0.195,	0.208,	0.205,	0.219,	0.232,	0.249,	0.245,	0.262,	0.276,	0.285,	0.291,	0.292,	0.302,	0.302,	0.315,	0.313,	0.322,	0.334,	0.333,	0.346,	0.357,	0.362,	0.374,	0.391,	0.387,	0.407,	0.423,	0.428,	0.435,	0.448,	0.457,	0.457,	0.470,	0.468,	0.480,	0.480,	0.492,	0.492,	0.502,	0.502,	0.510,	0.516,	0.523,	0.531,	0.537,	0.532,	0.543,	0.544,	0.553,	0.546,	0.554]					
    Y2=[0.006,	0.008,	0.013,	0.015,	0.020,	0.025,	0.033,	0.023,	0.045,	0.054,	0.040,	0.063,	0.050,	0.073,	0.060,	0.085,	0.071,	0.097,	0.082,	0.108,	0.120,	0.104,	0.131,	0.139,	0.150,	0.134,	0.157,	0.170,	0.162,	0.178,	0.168,	0.187,	0.177,	0.200,	0.189,	0.211,	0.221,	0.209,	0.232,	0.247,	0.243,	0.254,	0.266,	0.259,	0.273,	0.284,	0.277,	0.295,	0.303,	0.315,	0.300,	0.325,	0.311,	0.339,	0.328,	0.349,	0.339,	0.360,	0.350,	0.371,	0.382,	0.393,	0.410,	0.421,	0.395,	0.431,	0.442,	0.447,	0.422,	0.435]					
    X3=[0.001,	0.016,	0.027,	0.040,	0.059,	0.075,	0.089,	0.101,	0.111,	0.118,	0.124,	0.134,	0.139,	0.153,	0.152,	0.170,	0.184,	0.197,	0.210,	0.223,	0.233,	0.248,	0.259,	0.257,	0.271,	0.274,	0.281,	0.288,	0.287,	0.299,	0.304,	0.310,	0.316,	0.327,	0.343,	0.352,	0.368,	0.383,	0.377,	0.398,	0.409,	0.421,	0.418,	0.432,	0.443,	0.451,	0.442,	0.455,	0.460,	0.472,	0.466,	0.477,	0.471,	0.490,	0.480,	0.489,	0.500,	0.504,	0.499,	0.511,	0.506,	0.517,	0.512,	0.522,	0.519,	0.534,	0.534,	0.529,	0.534,	0.544,	0.546,	0.544,	0.552,	0.557]	
    Y3=[0.004,	0.007,	0.012,	0.015,	0.022,	0.029,	0.039,	0.049,	0.056,	0.069,	0.063,	0.078,	0.074,	0.087,	0.081,	0.094,	0.104,	0.115,	0.125,	0.137,	0.146,	0.157,	0.169,	0.159,	0.179,	0.188,	0.180,	0.197,	0.189,	0.207,	0.204,	0.216,	0.214,	0.223,	0.230,	0.238,	0.243,	0.253,	0.240,	0.264,	0.273,	0.283,	0.270,	0.294,	0.307,	0.320,	0.299,	0.312,	0.328,	0.340,	0.324,	0.349,	0.329,	0.359,	0.340,	0.350,	0.370,	0.380,	0.360,	0.390,	0.370,	0.399,	0.379,	0.409,	0.389,	0.420,	0.429,	0.404,	0.409,	0.440,	0.447,	0.427,	0.437,	0.446]	
    X4=[0.012,	0.013,	0.031,	0.048,	0.063,	0.058,	0.079,	0.097,	0.110,	0.116,	0.127,	0.142,	0.160,	0.160,	0.176,	0.173,	0.186,	0.195,	0.206,	0.217,	0.229,	0.235,	0.244,	0.255,	0.270,	0.264,	0.284,	0.298,	0.309,	0.324,	0.316,	0.339,	0.332,	0.349,	0.360,	0.373,	0.387,	0.401,	0.413,	0.426,	0.438,	0.452,	0.458,	0.469,	0.480,	0.492,	0.502,	0.500,	0.510,	0.518,	0.530,	0.528,	0.541,	0.545,	0.538,	0.554,	0.550,	0.565]																	
    Y4=[0.006,	0.002,	0.010,	0.015,	0.025,	0.014,	0.034,	0.042,	0.050,	0.047,	0.059,	0.068,	0.080,	0.072,	0.093,	0.081,	0.104,	0.113,	0.123,	0.132,	0.144,	0.142,	0.152,	0.163,	0.173,	0.158,	0.183,	0.194,	0.205,	0.217,	0.204,	0.226,	0.215,	0.236,	0.245,	0.254,	0.264,	0.274,	0.285,	0.295,	0.304,	0.311,	0.320,	0.328,	0.339,	0.349,	0.361,	0.350,	0.369,	0.378,	0.390,	0.379,	0.400,	0.410,	0.389,	0.413,	0.399,	0.412]																	
    X5=[0.008,	0.026,	0.043,	0.062,	0.078,	0.095,	0.111,	0.128,	0.144,	0.158,	0.171,	0.183,	0.197,	0.195,	0.209,	0.222,	0.238,	0.247,	0.248,	0.261,	0.270,	0.283,	0.296,	0.307,	0.315,	0.327,	0.340,	0.351,	0.364,	0.377,	0.371,	0.387,	0.402,	0.417,	0.433,	0.432,	0.451,	0.443,	0.467,	0.477,	0.488,	0.498,	0.506,	0.512,	0.521,	0.520,	0.527,	0.533,	0.541,	0.540,	0.550,	0.552,	0.560]																						
    Y5=[0.005,	0.010,	0.016,	0.023,	0.030,	0.039,	0.048,	0.055,	0.065,	0.076,	0.085,	0.095,	0.103,	0.092,	0.115,	0.122,	0.132,	0.149,	0.134,	0.156,	0.168,	0.177,	0.187,	0.198,	0.206,	0.214,	0.224,	0.234,	0.244,	0.253,	0.240,	0.264,	0.270,	0.278,	0.286,	0.279,	0.293,	0.286,	0.300,	0.310,	0.319,	0.327,	0.340,	0.331,	0.349,	0.340,	0.363,	0.351,	0.373,	0.360,	0.384,	0.369,	0.383]																						

    if FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = 0
        y2 = 0
        K1 = 0.0
        K2 = 0.1
    elif FoSKr <=0.2: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.1
        K2 = 0.2
    elif FoSKr <=0.3: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.2
        K2 = 0.3
    elif FoSKr <=0.4: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.3
        K2 = 0.4
    else: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.4
        K2 = 0.5

    i=0
    j=0
    F1SKr =0
    for xval in x1:       
        if xval >=  NbyNo:            
            F2SKr = prevy +((y1[i]-prevy)*(NbyNo-prex)/(xval-prex)) 
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NbyNo:            
            F2SKr1 = prevy +((y2[j]-prevy)*(NbyNo-prex)/(xval1-prex)) 
            break
        else:
            prex=xval1 
            prevy=y2[j]            
            j=j+1      
    corrected_Spbys = F2SKr + (F2SKr1-F2SKr)*(FoSKr-K1)/(K2-K1)
    return corrected_Spbys

def get_t2S2KR_from_Fig4_4(FoSKr,NbyNo):
    
    X1=[0.008,	0.027,	0.045,	0.063,	0.081,	0.091,	0.106,	0.125,	0.132,	0.148,	0.154,	0.170,	0.184,	0.198,	0.204,	0.210,	0.213,	0.228,	0.233,	0.248,	0.242,	0.259,	0.264,	0.276,	0.295,	0.286,	0.310,	0.326,	0.343,	0.360,	0.356,	0.376,	0.392,	0.405,	0.421,	0.432,	0.438,	0.453,	0.467,	0.471,	0.479,	0.482,	0.493,	0.501,	0.509,	0.523,	0.529,	0.544,	0.557,	0.574,	0.565,	0.590,	0.589,	0.604]
    Y1=[0.094,	0.095,	0.098,	0.101,	0.106,	0.114,	0.121,	0.129,	0.134,	0.138,	0.147,	0.151,	0.167,	0.179,	0.178,	0.198,	0.188,	0.205,	0.217,	0.228,	0.216,	0.243,	0.235,	0.253,	0.266,	0.253,	0.275,	0.288,	0.301,	0.318,	0.301,	0.333,	0.348,	0.366,	0.375,	0.390,	0.402,	0.411,	0.425,	0.416,	0.439,	0.434,	0.448,	0.461,	0.471,	0.479,	0.493,	0.503,	0.518,	0.531,	0.520,	0.546,	0.533,	0.550]
    X2=[0.007,	0.011,	0.028,	0.046,	0.046,	0.066,	0.080,	0.097,	0.115,	0.132,	0.128,	0.150,	0.165,	0.179,	0.194,	0.210,	0.222,	0.227,	0.243,	0.261,	0.279,	0.272,	0.296,	0.313,	0.308,	0.329,	0.347,	0.357,	0.372,	0.382,	0.391,	0.395,	0.406,	0.414,	0.429,	0.445,	0.456,	0.471,	0.486,	0.503,	0.519,	0.514,	0.537,	0.529,	0.550,	0.565,	0.565,	0.580,	0.583,	0.597,	0.595,	0.608]		
    Y2=[0.142,	0.153,	0.150,	0.157,	0.166,	0.167,	0.176,	0.183,	0.198,	0.211,	0.200,	0.223,	0.239,	0.248,	0.264,	0.269,	0.282,	0.280,	0.296,	0.307,	0.322,	0.302,	0.336,	0.350,	0.332,	0.367,	0.386,	0.398,	0.404,	0.416,	0.438,	0.424,	0.448,	0.440,	0.455,	0.466,	0.477,	0.485,	0.499,	0.507,	0.525,	0.503,	0.540,	0.522,	0.550,	0.567,	0.555,	0.585,	0.574,	0.595,	0.579,	0.603]		
    X3=[0.017,	0.035,	0.053,	0.071,	0.089,	0.107,	0.125,	0.143,	0.158,	0.173,	0.182,	0.200,	0.203,	0.220,	0.227,	0.243,	0.257,	0.274,	0.283,	0.297,	0.314,	0.331,	0.348,	0.364,	0.373,	0.381,	0.397,	0.412,	0.427,	0.443,	0.452,	0.456,	0.468,	0.464,	0.484,	0.477,	0.498,	0.511,	0.512,	0.530,	0.546,	0.556,	0.568,	0.580,	0.590,	0.600]							
    Y3=[0.196,	0.203,	0.211,	0.222,	0.232,	0.243,	0.252,	0.264,	0.275,	0.283,	0.295,	0.303,	0.312,	0.316,	0.325,	0.332,	0.347,	0.354,	0.362,	0.372,	0.382,	0.397,	0.409,	0.425,	0.418,	0.439,	0.451,	0.460,	0.474,	0.491,	0.505,	0.490,	0.525,	0.508,	0.537,	0.520,	0.553,	0.567,	0.552,	0.578,	0.588,	0.600,	0.609,	0.620,	0.633,	0.636]							
    X4=[0.007,	0.026,	0.023,	0.043,	0.061,	0.071,	0.081,	0.092,	0.099,	0.111,	0.127,	0.146,	0.164,	0.181,	0.201,	0.217,	0.237,	0.254,	0.273,	0.291,	0.310,	0.315,	0.326,	0.321,	0.341,	0.355,	0.352,	0.369,	0.372,	0.385,	0.389,	0.401,	0.415,	0.416,	0.431,	0.449,	0.440,	0.468,	0.485,	0.503,	0.521,	0.536,	0.551,	0.546,	0.564,	0.579,	0.576,	0.593,	0.593,	0.604,	0.614]			
    Y4=[0.229,	0.242,	0.235,	0.250,	0.260,	0.274,	0.270,	0.282,	0.282,	0.290,	0.299,	0.307,	0.317,	0.323,	0.336,	0.339,	0.349,	0.356,	0.361,	0.369,	0.378,	0.369,	0.392,	0.372,	0.406,	0.419,	0.401,	0.443,	0.433,	0.462,	0.451,	0.484,	0.498,	0.488,	0.509,	0.515,	0.504,	0.524,	0.528,	0.539,	0.551,	0.564,	0.578,	0.562,	0.592,	0.613,	0.596,	0.628,	0.613,	0.638,	0.641]			
    X5=[0.007,	0.025,	0.025,	0.045,	0.058,	0.074,	0.092,	0.110,	0.128,	0.146,	0.165,	0.183,	0.201,	0.219,	0.237,	0.255,	0.273,	0.291,	0.308,	0.323,	0.332,	0.343,	0.348,	0.355,	0.345,	0.366,	0.364,	0.379,	0.386,	0.403,	0.420,	0.437,	0.455,	0.471,	0.473,	0.488,	0.500,	0.514,	0.521,	0.534,	0.538,	0.552,	0.546,	0.567,	0.565,	0.583,	0.577,	0.595]						
    Y5=[0.262,	0.263,	0.274,	0.273,	0.281,	0.289,	0.298,	0.306,	0.314,	0.320,	0.326,	0.332,	0.339,	0.346,	0.352,	0.358,	0.365,	0.372,	0.382,	0.395,	0.412,	0.424,	0.443,	0.457,	0.410,	0.477,	0.462,	0.483,	0.495,	0.503,	0.514,	0.523,	0.534,	0.544,	0.539,	0.559,	0.577,	0.587,	0.603,	0.614,	0.606,	0.634,	0.614,	0.656,	0.641,	0.669,	0.653,	0.676]						
     
    if FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = 0
        y2 = 0
        K1 = 0.0
        K2 = 0.1
    elif FoSKr <=0.2: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.1
        K2 = 0.2
    elif FoSKr <=0.3: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.2
        K2 = 0.3
    elif FoSKr <=0.4: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.3
        K2 = 0.4
    else: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.4
        K2 = 0.5

    i=0
    j=0
    F1SKr =0
    print(K1, K2)
   
    for xval in x1:       
        if xval >=  NbyNo:            
            F2SKr = prevy +((y1[i]-prevy)*(NbyNo-prex)/(xval-prex))
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NbyNo:            
            F2SKr1 = prevy +((y2[j]-prevy)*(NbyNo-prex)/(xval1-prex))  
            break
        else:
            prex=xval1 
            prevy=y2[j]            
            j=j+1      
    corrected_Spbys = F2SKr + (F2SKr1-F2SKr)*(FoSKr-K1)/(K2-K1) 
    return corrected_Spbys


def get_F3SKr_from_fig4_5(FoSKr,NbyNo):

    X1=[0.010,	0.027,	0.043,	0.060,	0.076,	0.093,	0.109,	0.126,	0.142,	0.158,	0.175,	0.191,	0.207,	0.224,	0.240,	0.257,	0.273,	0.290,	0.306,	0.323,	0.339,	0.355,	0.372,	0.385,	0.399,	0.416,	0.432,	0.449,	0.465,	0.479,	0.495,	0.507,	0.522,	0.534,	0.547]															
    Y1=[0.090,	0.092,	0.095,	0.097,	0.100,	0.105,	0.110,	0.115,	0.122,	0.126,	0.132,	0.140,	0.145,	0.153,	0.161,	0.168,	0.176,	0.185,	0.194,	0.201,	0.210,	0.221,	0.233,	0.242,	0.253,	0.267,	0.282,	0.299,	0.310,	0.329,	0.345,	0.362,	0.377,	0.394,	0.402]															
    X2=[0.010,	0.027,	0.043,	0.059,	0.076,	0.110,	0.107,	0.127,	0.143,	0.160,	0.176,	0.193,	0.209,	0.226,	0.242,	0.258,	0.275,	0.291,	0.307,	0.324,	0.341,	0.356,	0.373,	0.385,	0.399,	0.409,	0.424,	0.435,	0.447,	0.444,	0.463,	0.476,	0.485,	0.497,	0.508,	0.521,	0.529,	0.545]												
    Y2=[0.159,	0.163,	0.165,	0.169,	0.173,	0.198,	0.183,	0.194,	0.193,	0.197,	0.202,	0.209,	0.215,	0.222,	0.229,	0.237,	0.245,	0.253,	0.263,	0.274,	0.286,	0.299,	0.310,	0.323,	0.334,	0.348,	0.360,	0.373,	0.394,	0.381,	0.402,	0.418,	0.432,	0.445,	0.462,	0.478,	0.497,	0.508]												
    X3=[0.006,	0.022,	0.038,	0.054,	0.071,	0.087,	0.104,	0.120,	0.136,	0.153,	0.170,	0.186,	0.202,	0.219,	0.235,	0.251,	0.268,	0.284,	0.301,	0.317,	0.334,	0.350,	0.366,	0.382,	0.392,	0.407,	0.400,	0.421,	0.433,	0.445,	0.457,	0.465,	0.475,	0.485,	0.495,	0.507,	0.521,	0.531,	0.543,	0.551]										
    Y3=[0.209,	0.213,	0.216,	0.220,	0.224,	0.227,	0.231,	0.234,	0.239,	0.243,	0.248,	0.253,	0.258,	0.265,	0.272,	0.279,	0.288,	0.297,	0.304,	0.317,	0.330,	0.344,	0.361,	0.379,	0.396,	0.412,	0.395,	0.430,	0.449,	0.467,	0.489,	0.503,	0.514,	0.529,	0.543,	0.564,	0.582,	0.603,	0.622,	0.630]										
    X4=[0.010,	0.026,	0.042,	0.058,	0.075,	0.092,	0.108,	0.125,	0.141,	0.157,	0.174,	0.190,	0.206,	0.223,	0.240,	0.256,	0.273,	0.289,	0.305,	0.321,	0.336,	0.350,	0.362,	0.373,	0.382,	0.396,	0.391,	0.409,	0.407,	0.424,	0.433,	0.446,	0.442,	0.461,	0.456,	0.471,	0.472,	0.485,	0.489,	0.505,	0.498,	0.518,	0.531,	0.546]						
    Y4=[0.245,	0.247,	0.250,	0.253,	0.256,	0.260,	0.260,	0.264,	0.269,	0.274,	0.278,	0.285,	0.289,	0.299,	0.304,	0.311,	0.322,	0.334,	0.345,	0.363,	0.381,	0.398,	0.410,	0.429,	0.447,	0.471,	0.457,	0.498,	0.481,	0.507,	0.524,	0.547,	0.529,	0.572,	0.557,	0.599,	0.583,	0.603,	0.623,	0.642,	0.617,	0.665,	0.686,	0.705]						
    X5=[0.010,	0.024,	0.028,	0.044,	0.062,	0.078,	0.095,	0.111,	0.128,	0.144,	0.161,	0.177,	0.194,	0.210,	0.226,	0.243,	0.259,	0.275,	0.268,	0.291,	0.285,	0.306,	0.321,	0.325,	0.336,	0.346,	0.358,	0.370,	0.366,	0.385,	0.379,	0.397,	0.409,	0.405,	0.420,	0.420,	0.433,	0.444,	0.454,	0.455,	0.468,	0.478,	0.487,	0.497,	0.508,	0.522,	0.515,	0.530,	0.544,	0.542]
    Y5=[0.250,	0.253,	0.273,	0.258,	0.259,	0.264,	0.268,	0.272,	0.276,	0.283,	0.289,	0.294,	0.299,	0.303,	0.310,	0.319,	0.329,	0.344,	0.320,	0.357,	0.332,	0.371,	0.390,	0.406,	0.418,	0.435,	0.452,	0.473,	0.454,	0.494,	0.476,	0.512,	0.531,	0.502,	0.550,	0.527,	0.557,	0.578,	0.598,	0.576,	0.609,	0.630,	0.648,	0.663,	0.683,	0.702,	0.677,	0.720,	0.747,	0.731]
    X6=[0.010,	0.026,	0.042,	0.059,	0.075,	0.092,	0.108,	0.125,	0.141,	0.157,	0.174,	0.190,	0.206,	0.223,	0.239,	0.254,	0.270,	0.287,	0.299,	0.307,	0.315,	0.327,	0.338,	0.349,	0.359,	0.356,	0.373,	0.376,	0.391,	0.402,	0.409,	0.422,	0.417,	0.432,	0.443,	0.455,	0.463,	0.470,	0.480,	0.480,	0.495,	0.504,	0.514,	0.526,	0.525,	0.540,	0.547]			
    Y6=[0.242,	0.245,	0.248,	0.248,	0.251,	0.256,	0.258,	0.263,	0.269,	0.275,	0.279,	0.287,	0.295,	0.303,	0.311,	0.322,	0.338,	0.357,	0.372,	0.393,	0.408,	0.417,	0.434,	0.450,	0.471,	0.459,	0.481,	0.499,	0.506,	0.524,	0.542,	0.556,	0.538,	0.575,	0.593,	0.610,	0.627,	0.644,	0.668,	0.643,	0.680,	0.703,	0.723,	0.749,	0.728,	0.763,	0.779]			
    print('FOSKR =', FoSKr)
    if FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = 0
        y2 = 0
        K1 = 0.0
        K2 = 0.1
        print(K1, K2)
    elif FoSKr <=0.2: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.1
        K2 = 0.2
        print(K1, K2)
    elif FoSKr <=0.3: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.2
        K2 = 0.3
        print(K1, K2)
    elif FoSKr <=0.4: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.3
        K2 = 0.4
        print(K1, K2)
    elif FoSKr <0.5: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.4
        K2 = 0.5
        print(K1, K2)
    elif FoSKr <0.5: 
        x1 = X5
        y1 = Y5
        x2 = X6
        y2 = Y6
        K1 = 0.5
        K2 = 0.6
        print(K1, K2)

    i=0
    j=0
    F1SKr =0
    print(K1, K2)
   
    for xval in x1:       
        if xval >=  NbyNo:            
            F2SKr = prevy +((y1[i]-prevy)*(NbyNo-prex)/(xval-prex))
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NbyNo:            
            F2SKr1 = prevy +((y2[j]-prevy)*(NbyNo-prex)/(xval1-prex))  
            break
        else:
            prex=xval1 
            prevy=y2[j]            
            j=j+1      
    corrected_Spbys = F2SKr + (F2SKr1-F2SKr)*(FoSKr-K1)/(K2-K1) 
    return corrected_Spbys

def get_Ta_from_fig_4_6(NNoder, FoSKr):

    X1=[0.004,	0.014,	0.023,	0.031,	0.040,	0.049,	0.058]																																								
    Y1=[0.109,	0.100,	0.092,	0.082,	0.073,	0.064,	0.055]																																								
    X2=[0.003,	0.009,	0.017,	0.026,	0.034,	0.043,	0.052,	0.060,	0.069,	0.076,	0.085,	0.094,	0.102,	0.111,	0.118]																																
    Y2=[0.172,	0.161,	0.151,	0.143,	0.134,	0.125,	0.117,	0.107,	0.098,	0.091,	0.081,	0.072,	0.063,	0.054,	0.049]																																
    X3=[0.003,	0.012,	0.021,	0.030,	0.039,	0.047,	0.054,	0.063,	0.072,	0.079,	0.089,	0.097,	0.104,	0.114,	0.123,	0.132,	0.141,	0.150,	0.155]																												
    Y3=[0.212,	0.202,	0.193,	0.182,	0.174,	0.165,	0.155,	0.147,	0.138,	0.127,	0.120,	0.111,	0.102,	0.095,	0.086,	0.076,	0.067,	0.058,	0.053]																												
    X4=[0.015,	0.025,	0.035,	0.044,	0.051,	0.058,	0.068,	0.076,	0.084,	0.093,	0.101,	0.111,	0.120,	0.129,	0.138,	0.147,	0.156,	0.166,	0.174,	0.183,	0.192,	0.202,	0.211,	0.220,	0.228,	0.237,	0.246,	0.256,	0.263]																		
    Y4=[0.306,	0.300,	0.283,	0.275,	0.271,	0.259,	0.250,	0.241,	0.232,	0.223,	0.214,	0.204,	0.196,	0.186,	0.175,	0.166,	0.156,	0.147,	0.139,	0.129,	0.121,	0.111,	0.101,	0.094,	0.084,	0.075,	0.065,	0.055,	0.050]																		
    X5=[0.014,	0.023,	0.030,	0.039,	0.048,	0.056,	0.066,	0.075,	0.082,	0.091,	0.099,	0.105,	0.115,	0.124,	0.132,	0.140,	0.150,	0.157,	0.165,	0.174,	0.183,	0.193,	0.200,	0.210,	0.218,	0.226,	0.235,	0.244,	0.253,	0.263,	0.272,	0.281,	0.290,	0.300,	0.306,	0.314,	0.323,	0.330,	0.335]								
    Y5=[0.379,	0.370,	0.362,	0.352,	0.344,	0.335,	0.325,	0.316,	0.308,	0.300,	0.291,	0.281,	0.274,	0.265,	0.257,	0.249,	0.240,	0.232,	0.224,	0.215,	0.206,	0.198,	0.189,	0.178,	0.169,	0.160,	0.151,	0.142,	0.132,	0.123,	0.114,	0.104,	0.096,	0.085,	0.077,	0.071,	0.061,	0.052,	0.050]								
    X6=[0.027,	0.040,	0.051,	0.063,	0.073,	0.082,	0.088,	0.101,	0.110,	0.132,	0.138,	0.156,	0.168,	0.180,	0.188,	0.197,	0.206,	0.215,	0.224,	0.230,	0.238,	0.247,	0.255,	0.264,	0.273,	0.282,	0.292,	0.301,	0.310,	0.320,	0.329,	0.339,	0.348,	0.358,	0.366,	0.377,	0.386,	0.395,	0.405,	0.412,	0.451,	0.467,	0.477,	0.486,	0.496,	0.503]	
    Y6=[0.438,	0.425,	0.412,	0.400,	0.380,	0.373,	0.375,	0.356,	0.350,	0.326,	0.325,	0.300,	0.281,	0.274,	0.261,	0.251,	0.242,	0.233,	0.225,	0.217,	0.209,	0.201,	0.190,	0.181,	0.173,	0.163,	0.153,	0.145,	0.136,	0.128,	0.122,	0.116,	0.110,	0.105,	0.101,	0.098,	0.094,	0.090,	0.087,	0.086,	0.088,	0.086,	0.088,	0.097,	0.097,	0.098]	
    X7=[0.017,	0.035,	0.052,	0.070,	0.088,	0.105,	0.123,	0.140,	0.163,	0.179,	0.196,	0.205,	0.214,	0.232,	0.227,	0.251,	0.254,	0.268,	0.276,	0.285,	0.294,	0.303,	0.312,	0.321,	0.329,	0.339,	0.346,	0.357,	0.375,	0.375,	0.393,	0.396,	0.412,	0.411,	0.425,	0.429,	0.447,	0.451,	0.462,	0.472,	0.481,	0.488,	0.496,	0.504,	0.505,	0.514,	0.516]
    Y7=[0.459,	0.442,	0.424,	0.406,	0.388,	0.370,	0.352,	0.334,	0.306,	0.294,	0.278,	0.600,	0.260,	0.242,	0.581,	0.224,	0.549,	0.206,	0.518,	0.187,	0.499,	0.170,	0.480,	0.153,	0.463,	0.140,	0.448,	0.127,	0.120,	0.423,	0.114,	0.397,	0.376,	0.112,	0.362,	0.112,	0.115,	0.348,	0.119,	0.323,	0.123,	0.299,	0.149,	0.274,	0.170,	0.196,	0.249]
    X8=[0.034,	0.051,	0.068,	0.085,	0.103,	0.121,	0.138,	0.138,	0.156,	0.156,	0.172,	0.174,	0.186,	0.192,	0.213,	0.208,	0.225,	0.223,	0.237,	0.243,	0.259,	0.260,	0.275,	0.278,	0.292,	0.296,	0.308,	0.314,	0.325,	0.332,	0.342,	0.349,	0.360,	0.369,	0.377,	0.387,	0.394,	0.399,	0.404,	0.429,	0.428,	0.439,	0.444,	0.446,	0.452,	0.451]	
    Y8=[0.493,	0.476,	0.458,	0.441,	0.423,	0.405,	0.596,	0.388,	0.578,	0.370,	0.561,	0.352,	0.550,	0.334,	0.525,	0.317,	0.299,	0.519,	0.496,	0.283,	0.473,	0.267,	0.453,	0.249,	0.436,	0.230,	0.419,	0.212,	0.401,	0.199,	0.383,	0.186,	0.364,	0.174,	0.346,	0.167,	0.328,	0.164,	0.319,	0.173,	0.299,	0.266,	0.194,	0.249,	0.225,	0.204]	
    X9=[0.069,	0.086,	0.081,	0.094,	0.104,	0.108,	0.121,	0.126,	0.139,	0.144,	0.156,	0.160,	0.172,	0.177,	0.190,	0.195,	0.208,	0.213,	0.226,	0.230,	0.244,	0.248,	0.262,	0.265,	0.278,	0.282,	0.295,	0.300,	0.312,	0.317,	0.329,	0.333,	0.347,	0.352,	0.364,	0.370,	0.377]										
    Y9=[0.545,	0.554,	0.527,	0.516,	0.539,	0.497,	0.520,	0.479,	0.502,	0.464,	0.485,	0.445,	0.468,	0.427,	0.451,	0.408,	0.433,	0.392,	0.415,	0.374,	0.398,	0.355,	0.379,	0.337,	0.363,	0.320,	0.346,	0.303,	0.327,	0.286,	0.309,	0.268,	0.293,	0.252,	0.276,	0.250,	0.264]										
    X10=[0.406,	0.415,	0.425,	0.434,	0.443,	0.452,	0.462,	0.473,	0.481,	0.487,	0.497,	0.503,	0.511,	0.515]																																	
    Y10=[0.597,	0.587,	0.578,	0.570,	0.559,	0.550,	0.542,	0.530,	0.522,	0.517,	0.503,	0.499,	0.493,	0.485]																																	

    if FoSKr <=0.1: 
        x1 = X1
        y1 = Y1
        x2 = 0
        y2 = 0
        K1 = 0.0
        K2 = 0.1
    elif FoSKr <=0.2: 
        x1 = X1
        y1 = Y1
        x2 = X2
        y2 = Y2
        K1 = 0.1
        K2 = 0.2
    elif FoSKr <=0.3: 
        x1 = X2
        y1 = Y2
        x2 = X3
        y2 = Y3
        K1 = 0.2
        K2 = 0.3
    elif FoSKr <=0.4: 
        x1 = X3
        y1 = Y3
        x2 = X4
        y2 = Y4
        K1 = 0.3
        K2 = 0.4
    else: 
        x1 = X4
        y1 = Y4
        x2 = X5
        y2 = Y5
        K1 = 0.4
        K2 = 0.5

    i=0
    j=0
    F2SKr =0
    print(K1, K2)
   
    for xval in x1:       
        if xval >=  NNoder:            
            F2SKr = prevy +((y1[i]-prevy)*(NNoder-prex)/(xval-prex))
            break
        else:
            prex=xval 
            prevy=y1[i]            
            i=i+1  
    for xval1 in x2:       
        if xval1 >=  NNoder:            
            F2SKr1 = prevy +((y2[j]-prevy)*(NNoder-prex)/(xval1-prex))  
            break
        else:
            prex=xval1 
            prevy=y2[j]            
            j=j+1      
    corrected_Spbys = F2SKr + (F2SKr1-F2SKr)*(FoSKr-K1)/(K2-K1) 

    return corrected_Spbys